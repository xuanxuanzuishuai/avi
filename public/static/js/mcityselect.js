(function(){function h(a,d,b){for(var c=0;c<b.length;c++)if(b[c][a]==d)return b[c].children}var k=[{id:3106,name:"\u56fd\u5185",children:[{id:2,name:"\u5b89\u5fbd"},{id:3,name:"\u5317\u4eac"},{id:4,name:"\u798f\u5efa"},{id:5,name:"\u7518\u8083"},{id:6,name:"\u5e7f\u4e1c"},{id:7,name:"\u5e7f\u897f"},{id:8,name:"\u8d35\u5dde"},{id:9,name:"\u6d77\u5357"},{id:10,name:"\u6cb3\u5317"},{id:11,name:"\u6cb3\u5357"},{id:12,name:"\u9ed1\u9f99\u6c5f"},{id:13,name:"\u6e56\u5317"},{id:14,name:"\u6e56\u5357"},{id:15,
name:"\u5409\u6797"},{id:16,name:"\u6c5f\u82cf"},{id:17,name:"\u6c5f\u897f"},{id:18,name:"\u8fbd\u5b81"},{id:19,name:"\u5185\u8499\u53e4"},{id:20,name:"\u5b81\u590f"},{id:21,name:"\u9752\u6d77"},{id:22,name:"\u5c71\u4e1c"},{id:23,name:"\u5c71\u897f"},{id:24,name:"\u9655\u897f"},{id:25,name:"\u4e0a\u6d77"},{id:26,name:"\u56db\u5ddd"},{id:27,name:"\u5929\u6d25"},{id:28,name:"\u897f\u85cf"},{id:29,name:"\u65b0\u7586"},{id:30,name:"\u4e91\u5357"},{id:31,name:"\u6d59\u6c5f"},{id:32,name:"\u91cd\u5e86"},
{id:33,name:"\u9999\u6e2f"},{id:34,name:"\u6fb3\u95e8"},{id:35,name:"\u53f0\u6e7e"}]}],j=function(a,d){this.data=[];this.elem=[];this.firstTxt=[];this.ajaxData=[];this.onchange=[];for(var b=0;b<a.length;b++){this.data[b]=a[b].data;this.elem[b]=fish.dom(a[b].query);this.firstTxt[b]=a[b].firstTxt;this.ajaxData[b]=a[b].ajaxData;this.onchange[b]=a[b].onchange}this.valueName=d.valueName?d.valueName:"name";this.allData=k;this.init();return this};j.prototype={init:function(){this.setFirstTxt();for(var a=
0;a<this.elem.length;a++){if(typeof this.data[a]==="number")this.data[a]=h("id",this.data[a],this.allData);this.data[a]&&this.bulid(a)}this.bindElem()},setFirstTxt:function(){for(var a=0;a<this.elem.length;a++){this.removeSele(a);this.elem[a].options[0]=new Option(this.firstTxt[a])}},setData:function(a,d,b,c){this.data[d]=a;this.bulid(d,b);c&&c()},bindElem:function(){for(var a=this,d=0;d<this.elem.length;d++)(function(b){fish.one(a.elem[b]).on("change",function(){var c;if(this.selectedIndex>0)c=h("id",
this.options[this.selectedIndex].getAttribute("_id"),a.data[b]);if(a.onchange[b])a.onchange[b](this,this.selectedIndex);if(c){if(a.elem[b+1]){a.data[b+1]=c;a.bulid(b+1)}}else a.ajaxData[b+1]&&a.elem[b].selectedIndex!=0&&a.ajaxSetData(b+1)})})(d)},ajaxSetData:function(a,d,b){var c,e=this;c=this.elem[a-1];if(e.ajaxData&&c){c=e.ajaxData[a](c.options[c.selectedIndex].getAttribute("_id"));fish.ajax({cache:true,type:"jsonp",url:c,fn:function(g){g&&g.result&&e.setData(g.result,a,d,b)}})}},removeSele:function(a){var d=
this.elem[a];for(a=this.elem[a].length-1;a>=0;a--)d.options[a]=null},bulid:function(a,d){if(this.data[a]){this.removeSele(a);var b=this.data[a].length,c=this.elem[a],e=this.data[a],g=true;if(this.firstTxt[a]!==null){var f=new Option(this.firstTxt[a],this.firstTxt[a]);f.setAttribute("_id",0);try{c.add(f,null)}catch(n){c.add(f)}c.selectedIndex=0}if(d&&d.only)g=false;for(i=0;i<b;i++)if(e[i].name!=="0"&&g||!g&&e[i].name===d.only){f=typeof this.valueName==="function"?this.valueName(e[i]):e[i][this.valueName];
f=new Option(e[i].name,f);f.setAttribute("_id",e[i].id);try{c.add(f,null)}catch(o){c.add(f)}d&&d.selected===e[i].name&&function(l,m){setTimeout(function(){l.selectedIndex=m+1},0)}(c,i)}this.bulid(a+1)}}};fish.extend({mCitySelect:function(a,d){var b=[];if(a.province)b.push({query:a.province,firstTxt:a.provinceFirstText?a.provinceFirstText:"\u8bf7\u9009\u62e9\u7701",data:3106});if(a.city)b.push({query:a.city,firstTxt:a.cityFirstText?a.cityFirstText:"\u8bf7\u9009\u62e9\u5e02",ajaxData:a.cityAjaxUrl?
a.cityAjaxUrl:function(c){return"http://www.17u.cn/hotel/ajax/HotelAjaxCall.aspx?action=GetCityByProvince&id="+c}});if(a.area)b.push({query:a.area,firstTxt:a.areaFirstText?a.areaFirstText:"\u8bf7\u9009\u62e9\u533a/\u53bf",ajaxData:a.areaAjaxUrl?a.areaAjaxUrl:function(c){return"http://www.17u.cn/hotel/ajax/HotelAjaxCall.aspx?action=GetAreaByCity&id="+c}});b=new j(b,a);d&&d(b);return b}})})();
