/*from tccdn minify at 2016-12-4 9:32:33,file：/cn/s/2016/pc/scenery/map/sFinal_map.0.2.js,file：/cn/public/module/lazyLoad/0.2/lazyLoad.js,file：/cn/s/2016/pc/scenery/index/toolBar/sToolBar.2.4.js?v=2015443466*/
function DC(a){return document.createElement(a)}(function(){var d=document;var _=window._=function(e){return typeof(e)=="string"?d.getElementById(e):e};var run=function(){for(var k in fn){fn[k]()}};_.isNumeric=function(obj){return !isNaN(parseFloat(obj))&&isFinite(obj)};_.isPoint=function(p){if(p){if(_.isNumeric(p.lng)&&_.isNumeric(p.lat)&&p.lng!=0&&p.lat!=0){return true}}return false};_.pointCorr=function(p){if(p){p.lng=parseFloat(p.lng);p.lat=parseFloat(p.lat)}};_.cEle=function(json){if(json&&json.name){var ele=document.createElement(json.name);delete json.name;if(json.text){try{ele.appendChild(document.createTextNode(json.text));delete json.text}catch(e){}}for(var k in json){try{if(/^[a-z0-9_]+$/i.test(k)){eval("ele."+k+"=json[k]")}}catch(e){}}return ele}};_.isStr=function(obj){return typeof(obj)=="string"};_.copyJson=function(json){var tempJson;if(typeof(json)!="undefined"){if(json==null){tempJson=null}else{if(json instanceof Array){tempJson=[];for(var i=0;i<json.length;i++){tempJson.push(arguments.callee(json[i]))}}else{if(typeof(json)!="object"){tempJson=json}else{try{tempJson={};var over=true;for(var k in json){over=false;tempJson[k]=arguments.callee(json[k])}if(over){tempJson=json}}catch(e){tempJson=json}}}}}return tempJson}})();var mapSystem={elements:(function(){var a={};a.panel=".mapside";a.return_btn=a.panel+" .return_btn:first";a.point_out=".point_out";a.nav=a.panel+" .nav";a.resultPanel=a.panel+" .line_search";a.inputLine=a.resultPanel+" .bus";a.lineTop=a.resultPanel+" .search_taxi";a.inputTxt=a.resultPanel+" .city_srh";a.searchTxtContent=a.resultPanel+" .other_ser input";a.searchTxtButton=a.resultPanel+" .other_ser a";a.txtResultPanel=a.panel+".results";a.txtResultRoundPanel=a.txtResultPanel+" .eye_srh";a.txtResultList=a.txtResultPanel+" .list_lf";a.hub=a.resultPanel+" .hub";a.round=a.resultPanel+" .view";a.other_ser=a.resultPanel+" .other_ser";a.resetSelect=a.resultPanel+" .map_reset_select";a.transitPolicy=a.lineTop+" .single";a.transitResult=a.resultPanel+" .dir_line";a.drivePolicy=a.lineTop+" .drive_single";a.driveResult=a.resultPanel+" .bus_way";return a})(),elementObjs:{},hideList:function(b){for(var a in b){this.e(b[a]).css("display:none")}},showList:function(b){for(var a in b){this.e(b[a]).css("display:block")}},iniElementView:function(){var a=["nav","inputLine","return_btn","other_ser","lineTop","inputTxt","hub","round","resetSelect","transitPolicy","transitResult","drivePolicy","driveResult","txtResultPanel","txtResultRoundPanel"];this.hideList(a)},e:function(a){return this.elementObjs[a]&&this.elementObjs[a].length>0&&this.elementObjs[a]||(this.elementObjs[a]=fish.all(this.elements[a]))},data:{type:"默认数据",mapId:"MapHolder",mapInfo:{city:"苏州",lng:120.626231,lat:31.335754},hotelInfo:{title:null,lng:null,lat:null},railwayStation:null,airport:null},map:null,reselectInfoWindow:new BMap.InfoWindow("",{offset:new BMap.Size(0,-27)}),controls:{contextMenu:null,menuItems:{}},jsonToPoint:function(a){return a&&new BMap.Point(a.lng,a.lat)},jsonConvertPoi:function(a){var b=this.jsonToPoint(a);if(a&&b){a.point=b}return a},lineUnifyStatus:function(a){mapSystem.transitHandle.status=a;mapSystem.driveHandle.status=a},txtUnifyStatus:function(a){mapSystem.viewSearch.status=a;mapSystem.otherHandle.status=a},reselectNowPoi:null,poiTypeNames:{},hotelLine:function(a,c){var b=c||this.reselectNowPoi;if(b){this.resetPoiContext();if(a){mapSystem.contextSearch(mapSystem.jsonConvertPoi(_.copyJson(mapSystem.data.hotelInfo)),b,"mouse")}else{mapSystem.contextSearch(b,mapSystem.jsonConvertPoi(_.copyJson(mapSystem.data.hotelInfo)),"mouse")}}},resetPoiContext:function(){if(mapSystem.reselectNowPoi){var d=mapSystem.reselectNowPoi.marker;var a=mapSystem.reselectNowPoi.cell;var b=null;if(a){var c=d.getIcon().imageOffset.width;fish.one(a).removeClass("cur");b=new BMap.Icon("http://img1.40017.cn/cn/s/map/2013/member_icoNew.png",new BMap.Size(23,27),{anchor:new BMap.Size(11,27),imageOffset:new BMap.Size(c,1)})}else{b=new BMap.Icon("http://img1.40017.cn/cn/s/map/2013/member_icoNew.png",new BMap.Size(14,16),{anchor:new BMap.Size(7,16),imageOffset:new BMap.Size(-674,-32)})}d.setIcon(b);d.setTop(false);mapSystem.reselectNowPoi=null}},setReselectPoint:function(c){var a=c||this.reselectNowPoi;if(a){if(a.isStart){var b=fish.one("#reselectStart");if(mapSystem.endMarker){var d=mapSystem.endMarker.getTitle();if(d=="拖动可改变终点"){d=""}mapSystem.contextSearch(a,{point:mapSystem.endMarker.getPosition(),title:d},"mouse")}else{mapSystem.startMarker=mapSystem.addMarkerFun(a.point,1,0,a.title);b[0].className="finish";var e=fish.one("#reselectStart h4");e.html(e.html().replace(/^(.+?：)[\s\S]*$/,"$1")+a.title);fish.dom("#reselectEnd h4").click()}}else{var b=fish.one("#reselectEnd");if(mapSystem.startMarker){var d=mapSystem.startMarker.getTitle();if(d=="拖动可改变起点"){d=""}mapSystem.contextSearch({point:mapSystem.startMarker.getPosition(),title:d},a,"mouse")}else{mapSystem.endMarker=mapSystem.addMarkerFun(a.point,1,1,a.title);b[0].className="finish";var e=fish.one("#reselectEnd h4");e.html(e.html().replace(/^(.+?：)[\s\S]*$/,"$1")+a.title);fish.dom("#reselectStart h4").click()}}this.resetPoiContext()}},autoMarkerTop:function(a){if(a){(function(){var b=a;b.addEventListener("mouseover",function(){b.setTop(true)});b.addEventListener("mouseout",function(){b.setTop(false)})})()}},startMarker:null,endMarker:null,searchNote:{type:null,time:0,policy:0,inputType:"",start:null,end:null,content:"",page:0},resetSearchNote:function(){this.searchNote={type:null,time:0,policy:0,inputType:"",start:null,end:null,content:"",page:0}},searchNow:{type:null,time:-1},updateSearchNow:function(a){var b=new Date().getTime();a.time=b;this.searchNow.type=a.type;this.searchNow.time=b},clearSearchNow:function(){this.searchNow.type=null;this.searchNow.time=-1},checkSearchNow:function(a){return this.searchNow.type&&this.searchNow.type==a.type&&this.searchNow.time==a.time},HandleType:null,getHandleType:function(a){var b=/[^"=\s]+cur/.exec(fish.one(a).html());return b=="taxicur"?"driveHandle":"transitHandle"},getHandlePolicy:function(a){var b=0;return b},contextSearch:function(f,a,c){var b=this.HandleType;var e=this.getHandlePolicy();var d={type:b,time:0,policy:e,inputType:c,start:f,end:a,content:"",page:0};mapSystem.updateSearchNow(d);openLoading();if(b=="driveHandle"){this.driveHandle.search(d)}else{this.transitHandle.search(d)}},searchTxt:function(b){if(b&&$.trim(b)!=""){b=$.trim(b);var a={type:"otherHandle",time:0,policy:0,inputType:"",start:null,end:null,content:b,page:0};mapSystem.updateSearchNow(a);mapSystem.otherHandle.search(a)}},markerSearch:function(){if(this.startMarker&&this.endMarker){this.contextSearch({point:this.startMarker.getPosition(),title:""},{point:this.endMarker.getPosition(),title:""},"mouse")}},addMarkerFun:function(j,e,f,k){var l;var m;var c;var i;if(e==1){l="http://img1.40017.cn/cn/new_ui/scenic/images/map/dest_markers.png";m=42;c=34;i=new BMap.Icon(l,new BMap.Size(m,c),{anchor:new BMap.Size(14,32),imageOffset:new BMap.Size(0,0-f*c)})}else{l="http://api.map.baidu.com/images/trans_icons.png";m=22;c=25;var b=25;var a=0;var g=0;if(f==2){b=21;a=5;g=1}i=new BMap.Icon(l,new BMap.Size(m,b),{offset:new BMap.Size(10,(11+g)),imageOffset:new BMap.Size(0,0-f*c-a)})}var h=new BMap.Marker(j,{icon:i});if(k!=null&&k!=""){h.setTitle(k)}if(e==1){h.setTop(true)}this.map.addOverlay(h);return h},setStartMarker:function(a){if(this.startMarker){this.startMarker.setPosition(a);if(fish.one(".map_reset_select").getCss("display")!="none"){this.startMarker.setTitle("");var b=fish.one("#reselectStart h4");b.html(b.html().replace(/^(.+?：)[\s\S]*$/,"$1")+"起点位置")}}else{this.startMarker=this.addMarkerFun(a,1,0,"拖动可改变起点");this.startMarker.enableDragging();this.map.addOverlay(this.startMarker)}return this.startMarker},setEndMarker:function(a){if(this.endMarker){this.endMarker.setPosition(a);if(fish.one(".map_reset_select").getCss("display")!="none"){this.endMarker.setTitle("");var b=fish.one("#reselectEnd h4");b.html(b.html().replace(/^(.+?：)[\s\S]*$/,"$1")+"终点位置")}}else{this.endMarker=this.addMarkerFun(a,1,1,"拖动可改变终点");this.endMarker.enableDragging();this.map.addOverlay(this.endMarker)}return this.endMarker},addBGCur:function(a){fish.one(a).on("mouseover",function(){fish.one(this).addClass("gb_cur")});fish.one(a).on("mouseout",function(){fish.one(this).removeClass("gb_cur")})},isHotelData:function(a){var b=mapSystem.data.hotelInfo;return a&&b&&a.lng==b.lng&&a.lat==b.lat&&a.title==b.title},autoCreateTitle:function(argu){if(argu&&argu.length>0){var alter=function(obj){var arguTemp=argu;new BMap.Geocoder().getLocation(obj.point,function(rs){obj.title=rs.addressComponents.street;if(obj.title==null||fish.trim(obj.title)==""){obj.title="未知路段"}var str="";for(var i=0;i<arguTemp.length;i++){str+=",arguTemp["+i+"]"}eval("arguTemp.callee("+str.substr(1)+")")})};var start=argu[0].start,end=argu[0].end;if(typeof(start)=="object"){if(mapSystem.isHotelData(start)){start.title=mapSystem.hotelSearchString}else{if(start.title==""){alter(start);return true}}}if(typeof(end)=="object"){if(mapSystem.isHotelData(end)){end.title=mapSystem.hotelSearchString}else{if(end.title==""){alter(end);return true}}}}return false},addLineLabel:function(a,b){(function(){var d=new BMap.Polyline(b,{strokeColor:"red",strokeWeight:6,strokeOpacity:0.5});a.onmouseover=function(){mapSystem.map.addOverlay(d)};a.onmouseout=function(){mapSystem.map.removeOverlay(d)};var c=b;a.onclick=function(){mapSystem.map.setViewport(c);return false}})()},resetView:function(){this.map.clearOverlays();this.startMarker=null;this.endMarker=null},returnDefaultView:function(a){mapSystem.lineUnifyStatus(0);mapSystem.txtUnifyStatus(0);mapSystem.resetSearchNote();mapSystem.clearSearchNow();mapSystem.iniElementView();mapSystem.resetView();mapSystem.map.setCenter(mapSystem.jsonConvertPoi(_.copyJson(mapSystem.data.hotelInfo)).point);return false},setStartAndEndPoint:function(b){var c=b.getStart().title;var a=b.getEnd().title;this.startMarker=this.addMarkerFun(b.getStart().point,1,0,c);this.endMarker=this.addMarkerFun(b.getEnd().point,1,1,a);this.startMarker.enableDragging();this.endMarker.enableDragging();this.startMarker.addEventListener("dragend",function(d){mapSystem.searchNote.start={point:d.point,title:""};mapSystem.contextSearch(mapSystem.searchNote.start,mapSystem.searchNote.end,"mouse")});this.endMarker.addEventListener("dragend",function(d){mapSystem.searchNote.end={point:d.point,title:""};mapSystem.contextSearch(mapSystem.searchNote.start,mapSystem.searchNote.end,"mouse")})},viewSearch:{map:null,handle:null,type:"viewSearch",status:0,viewData:{normal:["nav","inputLine","hub","round","other_ser"],result:["return_btn","txtResultPanel","txtResultRoundPanel","round"]},view:function(){mapSystem.iniElementView();switch(this.status){case 8:mapSystem.showList(this.viewData.result);break;default:break}mapSystem.up_scrollbar()},search:function(){var a=mapSystem.viewSearch.handle;(function(){var b=json;a.setSearchCompleteCallback(function(c){if(mapSystem.checkSearchNow(b)){}})})()},init:function(){this.map=mapSystem.map;this.handle=new BMap.LocalSearch(this.map,{pageCapacity:30})}},transitHandle:{map:null,handle:null,type:"transitHandle",status:0,viewData:{normal:["nav","inputLine","hub","round","other_ser"],result:["nav","inputLine","lineTop","transitPolicy","transitResult","return_btn"],reset:["nav","inputLine","resetSelect","return_btn"]},view:function(){mapSystem.iniElementView();switch(this.status){case 1:mapSystem.showList(this.viewData.reset);break;case 8:mapSystem.showList(this.viewData.result);break;default:mapSystem.showList(this.viewData.normal);break}},search:function(b){if(mapSystem.checkSearchNow(b)){if(mapSystem.autoCreateTitle(arguments)){return}var a=mapSystem.transitHandle.handle;(function(){var g=[BMAP_TRANSIT_POLICY_LEAST_TIME,BMAP_TRANSIT_POLICY_LEAST_TRANSFER,BMAP_TRANSIT_POLICY_LEAST_WALKING,BMAP_TRANSIT_POLICY_AVOID_SUBWAYS];var h=b;var e=null;var j=null;var i=function(){if(e&&j&&mapSystem.checkSearchNow(h)){mapSystem.resetView();mapSystem.searchNote=h;mapSystem.txtUnifyStatus(0);mapSystem.lineUnifyStatus(8);var n=fish.one(".taxi");if(j.taxiFare&&j.taxiFare.day.totalFare){n.html("打车费约<b>"+j.taxiFare.day.totalFare+"元</b>");n.css("display:block")}else{n.css("display:none")}var z=fish.dom(".dir_line div ol");z.innerHTML="";if(a.getStatus()==BMAP_STATUS_SUCCESS){var m=function(E,D,F){if(D&&D.getDistance(false)>0){var G=DC("p");G.innerHTML='<span class="footcn"></span><a class="frg dis_a">'+D.getDistance(true)+"</a><em>步行至</em>";mapSystem.addBGCur(G);G.onclick=function(){mapSystem.map.setViewport(H.getPath())};var H=new BMap.Polyline(D.getPath(),{strokeStyle:"dashed",strokeColor:"red",strokeOpacity:0.75,strokeWeight:4,enableMassClear:true});G.onmouseover=function(){mapSystem.map.addOverlay(H)};G.onmouseout=function(){mapSystem.map.removeOverlay(H)};var C=DC("a");C.href="javascript:;";C.innerHTML=F;G.appendChild(C);E.appendChild(G)}};var B=e.getStart().title;var q=e.getEnd().title;for(var r=0;r<e.getNumPlans();r++){var t=e.getPlan(r);var s=DC("li");s.className="list_hid list_cur";z.appendChild(s);var p=DC("div");s.appendChild(p);var l=DC("a");l.className="frg c_arrow";l.href="javascript:;";l.innerHTML="";p.appendChild(l);(function(){var D=l;var M=r;var S=0.45;var U=t;var E=new Array();var V=null;var C=function(ac){for(var ab=0;ab<ac.length;ab++){E.push(ac[ab])}V.push(new BMap.Polyline(ac,{strokeColor:"red",strokeWeight:6,strokeOpacity:0.5}))};var G=function(){if(V==null){V=new Array();for(var ab=0;ab<U.getNumRoutes();ab++){var ad=U.getRoute(ab);if(ad.getDistance(false)>0){C(ad.getPath())}}for(var ab=0;ab<U.getNumLines();ab++){var ac=U.getLine(ab);C(ac.getPath())}}};p.onmouseover=function(ab){G();for(var ac in V){mapSystem.map.addOverlay(V[ac])}};p.onmouseout=function(ab){for(var ac in V){mapSystem.map.removeOverlay(V[ac])}};p.onclick=function(){var ae=this.parentNode;if(ae.className!=""){fish.all("li",fish.one(ae.parentNode)).addClass("list_hid list_cur");fish.all("a.c_arrow",fish.one(ae.parentNode)).attr("title","详情");fish.one("a.c_arrow",fish.one(ae)).attr("title","收起");fish.dom(ae).className="";mapSystem.resetView();G();for(var ab=0;ab<U.getNumRoutes();ab++){var ad=U.getRoute(ab);if(ad.getDistance(false)>0){mapSystem.map.addOverlay(new BMap.Polyline(ad.getPath(),{strokeStyle:"dashed",strokeColor:"#30a208",strokeOpacity:0.75,strokeWeight:4,enableMassClear:true}))}}for(var ab=0;ab<U.getNumLines();ab++){var ac=U.getLine(ab);if(ac.type==BMAP_LINE_TYPE_BUS){mapSystem.addMarkerFun(ac.getGetOnStop().point,2,2,ac.getGetOnStop().title);mapSystem.addMarkerFun(ac.getGetOffStop().point,2,2,ac.getGetOffStop().title)}else{if(ac.type==BMAP_LINE_TYPE_SUBWAY){mapSystem.addMarkerFun(ac.getGetOnStop().point,2,3,ac.getGetOnStop().title);mapSystem.addMarkerFun(ac.getGetOffStop().point,2,3,ac.getGetOffStop().title)}}mapSystem.map.addOverlay(new BMap.Polyline(ac.getPath(),{strokeColor:"#0030ff",strokeOpacity:S,strokeWeight:6,enableMassClear:true}));mapSystem.setStartAndEndPoint(e)}}mapSystem.map.setViewport(E)};s.onmouseover=function(){if(fish.one(this).hasClass("list_cur")){fish.one(this).removeClass("list_cur")}};s.onmouseout=function(){if(fish.one(this).hasClass("list_hid")){fish.dom(this).className="list_hid list_cur"}};l.onclick=function(ab){var ac=fish.one(this);if(ac.hasClass("c_arrow")){fish.stopBubble(ab);if(fish.one(this.parentNode.parentNode).hasClass("list_hid")){fish.all("li",fish.one(this.parentNode.parentNode.parentNode)).addClass("list_hid list_cur");fish.dom(this.parentNode.parentNode).className="";fish.dom(this).title="收起"}else{fish.dom(this.parentNode.parentNode).className="list_hid";fish.dom(this).title="详情"}return false}};var Q=DC("span");Q.className="min_ico";Q.innerHTML=(r+1);p.appendChild(Q);var K=DC("h6");p.appendChild(K);var J=DC("font");s.appendChild(J);J.innerHTML="全程约"+t.getDuration(true)+"/"+t.getDistance(true);var W=DC("p");W.className="start1";var X=DC("span");var R=DC("span");R.className="nm_bg";R.innerHTML='<span class="nm_l">'+B+'</span><span class="nm_b"></span>';X.className="start_ico";W.appendChild(X);W.appendChild(R);s.appendChild(W);var P="";for(var N=0,F=0;N<t.getNumLines();N++){var O=t.getLine(N);var Y=O.title.replace(/\([\s\S]*$/,"");if(O.type==BMAP_LINE_TYPE_BUS&&/^\d+$/.test(Y)){Y+="路"}P+="→"+Y;m(s,t.getRoute(F++),O.getGetOnStop().title);var T=DC("p");mapSystem.addBGCur(T);var L="";var Z=O.type==BMAP_LINE_TYPE_BUS&&"公交车"||O.type==BMAP_LINE_TYPE_SUBWAY&&"地铁"||O.type==BMAP_LINE_TYPE_FERRY&&"渡轮";switch(Z){case"公交车":L="icoBUS";break;case"地铁":L="icoSUBWAY";break;case"渡轮":L="icoFERRY";break}T.innerHTML='<a class="'+L+'" align="absmiddle" title="乘坐'+Z+'"></a><a href="#" class="frg clo_6d w_50">'+O.getNumViaStops()+'站</a>乘坐<a href="javascript:;">'+Y+"</a>"+Z+'，在<a href="javascript:;">'+O.getGetOffStop().title+"</a>下车";mapSystem.addLineLabel(T,O.getPath());s.appendChild(T)}m(s,t.getRoute(F++),q);P=P.length>0?P.substr(1):"";K.innerHTML=P;var aa=DC("p");aa.className="end1";var H=DC("span");H.className="end_ico";var I=DC("span");I.className="nm_bg";I.innerHTML='<span class="nm_l">'+q+'</span><span class="nm_b"></span>';aa.appendChild(H);aa.appendChild(I);s.appendChild(aa)})()}fish.dom("li div",z).click();fish.one(".map_reset_select").css("display:none");fish.one("#mapPanelBton").css("display:block")}else{if(h.inputType=="mouse"){var A=function(C){var D=z;var F=DC("li");var E=DC("div");fish.one(E).css("padding:5px;background:#f5f5f5;width:230px");F.appendChild(E);D.appendChild(F);if(typeof(C)=="string"){E.innerHTML=C}return E};if(d.getStatus()==BMAP_STATUS_SUCCESS){var w=j.getPlan(0);var v=w.getRoute(0).getPath();mapSystem.setStartAndEndPoint(j);if(w.getDistance(false)<3000){A("起点与终点较近，约"+w.getDistance(true)+"，您可选择步行前往。")}else{var y=A();var x=DC("a");x.href="javascript:;";x.innerHTML="驾车或打车";x.onclick=function(){fish.dom("#mapPanelBton .taxi").click();return false};var u=DC("span");u.innerHTML="找不到公交线路，您可选择";var o=DC("span");o.innerHTML="到达目的地，约"+w.getDistance(true)+"公里。";y.appendChild(u);y.appendChild(x);y.appendChild(o);fish.one(".map_reset_select").css("display:none")}}else{mapSystem.lastReselectJson=h;mapSystem.reselectInput();A("找不到往目的地公交路线，请重新选择。");fish.one("#mapPanelBton").css("display:none")}}else{mapSystem.lineUnifyStatus(1);mapSystem.lastReselectJson=h;mapSystem.reselectInput();fish.one(".map_reset_select").css("display:block")}}fish.one("#sceneryInfoListDiv").css("display:none");fish.one("#mapPanel").css("display:block");fish.one(".dir_line").css("display:block");fish.one(".search_taxi").css("display:block");fish.one(".bus_way").css("display:none");fish.one(".t_all_scenery").addClass("none");fish.one("#toLastSearch").removeClass("none");resetControl();closeLoading()}};var d=new BMap.DrivingRoute(mapSystem.transitHandle.map,{onSearchComplete:function(l){j=l;i()}});a.setPolicy(g[b.policy]);a.setSearchCompleteCallback(function(l){e=l;i()});var k=mapSystem.map.getZoom();if(k<9&&b.start.point&&b.end.point){var c=mapSystem.map.getCenter();var f=b.start.point&&b.end.point;mapSystem.map.setViewport([b.start.point,b.end.point]);a.search(b.start,b.end);mapSystem.map.setCenter(c);mapSystem.map.setZoom(k)}else{a.search(b.start,b.end)}d.search(b.start,b.end)})()}},init:function(){this.map=mapSystem.map;this.handle=new BMap.TransitRoute(this.map)}},driveHandle:{map:null,handle:null,type:"driveHandle",status:0,viewData:{normal:["nav","inputLine","hub","round","other_ser"],result:["nav","inputLine","lineTop","drivePolicy","driveResult","return_btn"],reset:["nav","inputLine","resetSelect","return_btn"]},view:function(){mapSystem.iniElementView();switch(this.status){case 1:mapSystem.showList(this.viewData.reset);break;case 8:mapSystem.showList(this.viewData.result);break;default:mapSystem.showList(this.viewData.normal);break}},search:function(b){if(mapSystem.checkSearchNow(b)){if(mapSystem.autoCreateTitle(arguments)){return}var a=mapSystem.driveHandle.handle;(function(){var c=[BMAP_DRIVING_POLICY_LEAST_TIME,BMAP_DRIVING_POLICY_LEAST_DISTANCE,BMAP_DRIVING_POLICY_AVOID_HIGHWAYS];var d=b;a.setPolicy(c[b.policy]);a.setSearchCompleteCallback(function(v){if(!v){return}mapSystem.resetView();if(mapSystem.checkSearchNow(d)){mapSystem.searchNote=d;mapSystem.lineUnifyStatus(8);var f=fish.one(".search_taxi .taxi");if(v.taxiFare&&v.taxiFare.day.totalFare){f.css("display:block");f.html("打车费约 <b>"+v.taxiFare.day.totalFare+"元</b>")}else{f.css("display:none")}var g=fish.one(".drive");var y=fish.all("ul",g)[1];y.innerHTML="";if(a.getStatus()==BMAP_STATUS_SUCCESS){if(v.getNumPlans()>0){var A=v.getStart().title;var k=v.getEnd().title;mapSystem.setStartAndEndPoint(v);var s=v.getPlan(0);var D=DC("li");var E=DC("p");var F=DC("h4");fish.one(D).css("background:#f5f5f5;text-indent:20px;border-bottom:none");fish.one(F).css("font-size:12px;font-weight:bold;font-family:'宋体';");F.innerHTML=A+" → "+k;E.className="juli_p";E.innerHTML="全程约"+s.getDuration(true)+"/"+s.getDistance(true);D.appendChild(F);D.appendChild(E);y.appendChild(D);var r=DC("li");var z=DC("span");z.className="start_ico";var B=DC("span");B.className="nm_bg";B.innerHTML='<span class="nm_l">'+A+'</span><span class="nm_b"></span>';fish.one(z).css("margin-top:5px");fish.one(B).css("margin-top:5px");r.appendChild(z);r.appendChild(B);y.appendChild(r);var x="";for(var m=0;m<s.getNumRoutes();m++){var w=s.getRoute(m);var u=w.getPath();mapSystem.addLineLabel(D,u);D.click();var t=0;mapSystem.map.addOverlay(new BMap.Polyline(u,{strokeColor:"#0030ff",strokeOpacity:0.45,strokeWeight:6,enableMassClear:true}));var o=v.getStart().point;var e=new Array();for(var n=1;n<w.getNumSteps();n++){var C=w.getStep(n);var p=DC("li");mapSystem.addBGCur(p);p.innerHTML="<em>"+(n)+".</em><p>"+(n==1?w.getStep(0).getDescription()+"，":"")+C.getDescription()+"</p>";for(;t<u.length;t++){e.push(u[t]);if(C.getPosition().equals(u[t])){break}}mapSystem.addLineLabel(p,e);y.appendChild(p)}}var q=DC("li");q.className="end1";var h=DC("span");h.className="end_ico";var l=DC("span");l.className="nm_bg";l.innerHTML='<span class="nm_l">'+k+'</span><span class="nm_b"></span>';fish.one(h).css("margin-top:5px");fish.one(l).css("margin-top:5px");q.appendChild(h);q.appendChild(l);y.appendChild(q)}fish.one(".map_reset_select").css("display:none");fish.one("#mapPanelBton").css("display:block")}else{if(d.inputType=="mouse"){(function(i){var j=DC("li");var G=DC("div");fish.one(G).css("padding:5px;background:#F5F5F5;");j.appendChild(G);y.appendChild(j);if(typeof(i)=="string"){G.innerHTML=i}return G})("找不到往目的地路线，请重新选择。");if(d.start.point){mapSystem.setStartMarker(d.start.point)}if(d.end.point){mapSystem.setEndMarker(d.end.point)}mapSystem.lineUnifyStatus(1);mapSystem.lastReselectJson=d;mapSystem.reselectInput()}fish.one(".map_reset_select").css("display:block");fish.one("#mapPanelBton").css("display:none")}}fish.one("#sceneryInfoListDiv").css("display:none");fish.one("#mapPanel").css("display:block");fish.one(".dir_line").css("display:none");fish.one(".search_taxi").css("display:block");fish.one(".bus_way").css("display:block");fish.one(".t_all_scenery").addClass("none");fish.one("#toLastSearch").removeClass("none");resetControl();closeLoading()});a.search(b.start,b.end)})()}},init:function(){this.map=mapSystem.map;this.handle=new BMap.DrivingRoute(this.map)}},otherHandle:{map:null,handle:null,type:"otherHandle",status:0,viewData:{normal:["nav","inputLine","hub","round","other_ser"],result:["return_btn","txtResultPanel","other_ser"]},view:function(){mapSystem.iniElementView();switch(this.status){case 8:mapSystem.showList(this.viewData.result);break;default:mapSystem.showList(this.viewData.normal);break}},search:function(){var a=mapSystem.otherHandle.handle;(function(){var b=json;a.setSearchCompleteCallback(function(c){if(mapSystem.checkSearchNow(b)){}})})()},init:function(){this.map=mapSystem.map;this.handle=new BMap.LocalSearch(this.map,{pageCapacity:10})}},getReselectTitle:function(a){return a&&(_.isStr(a)?a:a.title)},checkIsHotel:function(b){if(typeof(b)=="object"){var a=mapSystem.jsonConvertPoi(_.copyJson(mapSystem.data.hotelInfo));return b.point.equals(a.point)}return false},lastReselectJson:null,reselectInput:function(){if(mapSystem.lastReselectJson){var d=mapSystem.getReselectTitle(mapSystem.lastReselectJson.start);var a=mapSystem.getReselectTitle(mapSystem.lastReselectJson.end);var c=function(f,g){var e=fish.all(f);e.attr("class","rel_msg");var h=fish.one("h4",e);h.html(h.html().replace(/^(.+?：)[\s\S]*$/,"$1")+g);fish.one(".map_reset_select").css("display:block")};c("#reselectStart",d);c("#reselectEnd",a);if(mapSystem.lastReselectJson.inputType=="mouse"){fish.dom("#reselectStart h4").click()}else{var b=mapSystem.jsonConvertPoi(_.copyJson(mapSystem.data.hotelInfo));if(mapSystem.checkIsHotel(mapSystem.lastReselectJson.start)){b.isStart=true;mapSystem.setReselectPoint(b)}else{if(mapSystem.checkIsHotel(mapSystem.lastReselectJson.end)){b.isStart=false;mapSystem.setReselectPoint(b)}else{fish.dom("#reselectStart h4").click()}}}}},_initMap:function(){this.map=mapSystem.map;this.map=new BMap.Map(this.data.mapId);if(!_.isPoint(this.data.mapInfo)){var c=new BMap.Geocoder();c.getPoint(this.data.mapInfo.sName,function(e){mapSystem.map.centerAndZoom(e,12)},this.data.mapInfo.sName)}else{var d=this.jsonToPoint(this.data.mapInfo);this.map.centerAndZoom(d,12)}this.map.enableInertialDragging();this.map.enableDragging();fish.one(".traf_map").on("click",function(){mapSystem.map.enableScrollWheelZoom()});this.map.enableDoubleClickZoom();this.map.enableKeyboard();this.map.enableContinuousZoom();var a=new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE});this.map.addControl(a);this.map_ctrl_ove=new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,isOpen:0});this.map.addControl(this.map_ctrl_ove);var b=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});this.map.addControl(b);this.map.addControl(new BMap.ScaleControl());this.map.addControl(new BMap.OverviewMapControl())},_initElementEvent:function(){fish.all("#mapPanelBton a").on("click",function(){var d=fish.one(this);if(mapSystem.searchNote.type=="transitHandle"){if(d.hasClass("setBack")){mapSystem.searchNote.type=mapSystem.HandleType="transitHandle";if(mapSystem.searchNote&&mapSystem.searchNote.type=="transitHandle"&&mapSystem.transitHandle.status==8){mapSystem.contextSearch(mapSystem.searchNote.end,mapSystem.searchNote.start,"mouse")}}else{if(d.html()=="自驾"){mapSystem.searchNote.type=mapSystem.HandleType="driveHandle";if(mapSystem.searchNote&&mapSystem.searchNote.type=="driveHandle"&&mapSystem.driveHandle.status==8){mapSystem.contextSearch(mapSystem.searchNote.start,mapSystem.searchNote.end,"mouse")}d.html("公交")}}}else{if(d.hasClass("setBack")){mapSystem.searchNote.type=mapSystem.HandleType="driveHandle";if(mapSystem.searchNote&&mapSystem.searchNote.type=="driveHandle"&&mapSystem.driveHandle.status==8){mapSystem.contextSearch(mapSystem.searchNote.end,mapSystem.searchNote.start,"mouse")}}else{if(d.html()=="公交"){mapSystem.searchNote.type=mapSystem.HandleType="transitHandle";if(mapSystem.searchNote&&mapSystem.searchNote.type=="transitHandle"&&mapSystem.transitHandle.status==8){mapSystem.contextSearch(mapSystem.searchNote.start,mapSystem.searchNote.end,"mouse")}d.html("自驾")}else{if(d.html()=="自驾"){mapSystem.searchNote.type=mapSystem.HandleType="driveHandle";if(mapSystem.searchNote&&mapSystem.searchNote.type=="driveHandle"&&mapSystem.driveHandle.status==8){mapSystem.contextSearch(mapSystem.searchNote.start,mapSystem.searchNote.end,"mouse")}d.html("公交")}}}}});var a=function(l,m){mapSystem.reselectNowPoi=null;if(!fish.dom(".msg_p",fish.one(m))){var j=DC("p");j.className="msg_p";j.innerHTML="&nbsp;";m.appendChild(j)}else{var j=fish.dom(".msg_p")}var f=l==mapSystem.lastReselectJson.resetStart;if(l&&l.length>0){var k=[];j.innerHTML="找到"+l.length+"个地点，请从以下列表中选择";var g=DC("div");g.className="msg_list";var h=DC("div");h.className="list_lf";g.appendChild(h);m.appendChild(g);var d=fish.all(".list_lf",fish.one(m))[0];fish.one(d).html("");for(var e=0;e<l.length;e++){(function(){var v=l[e];v.isStart=f;k.push(v.point);var n=DC("div");n.className="list";n.innerHTML='<dl><dt></dt><dd><p><strong></strong></p><p>&nbsp;</p></dd></dl><a href="javascript:;" class="cur_bot">设为'+(v.isStart?"起点":"终点")+"</a>";d.appendChild(n);var s=fish.all("strong",fish.one(n))[0];s.innerHTML=v.title;var i=fish.all("p",fish.one(n))[1];if(v.address&&v.address.length>0){fish.one(i).html((typeof(mapSystem.poiTypeNames[v.type])!="undefined"?mapSystem.poiTypeNames[v.type]+":":"")+v.address)}var o=fish.all("dt",fish.one(n))[0];var p=e*-25;o.innerHTML=e+1;var r=new BMap.Icon("http://img1.40017.cn/cn/s/map/2013/member_icoNew.png",new BMap.Size(23,30),{anchor:new BMap.Size(11,27),imageOffset:new BMap.Size(p,1)});var q=new BMap.Marker(v.point,{icon:r,title:v.title});mapSystem.map.addOverlay(q);var u=function(){q.setIcon(new BMap.Icon("http://img1.40017.cn/cn/s/map/2013/member_icoNew.png",new BMap.Size(23,30),{anchor:new BMap.Size(11,27),imageOffset:new BMap.Size(p,-29)}));q.setTop(true)};var t=function(){if(mapSystem.reselectNowPoi==v){return}q.setIcon(new BMap.Icon("http://img1.40017.cn/cn/s/map/2013/member_icoNew.png",new BMap.Size(23,30),{anchor:new BMap.Size(11,27),imageOffset:new BMap.Size(p,1)}));q.setTop(false)};q.addEventListener("mouseover",u);q.addEventListener("mouseout",t);n.onclick=function(){mapSystem.setReselectPoint(v);return false};n.onmouseover=function(x){u();var w=fish.all("p",fish.one(v.cell))[1].innerHTML;mapSystem.reselectInfoWindow.setTitle('<div class="infoWindowTit">'+v.title+"</div>");mapSystem.reselectInfoWindow.setContent('<div class="setpoint_addr">'+w+'</div><div class="set_box"><a href="javascript:;" class="setpoint" onclick="mapSystem.setReselectPoint()">设为'+(v.isStart?"起点":"终点")+"</a></div>");q.openInfoWindow(mapSystem.reselectInfoWindow);fish.one(n).addClass("cur");q.setTop(true);mapSystem.reselectNowPoi=v};q.addEventListener("click",function(){n.click()});v.marker=q;v.cell=n})()}mapSystem.map.setViewport(k)}else{fish.dom(".msg_p").innerHTML="没找到相关的地点,您可以更换关键字搜索"}};mapSystem.reselectInfoWindow.addEventListener("close",function(){mapSystem.resetPoiContext()});var c=function(d,f){if(mapSystem.lastReselectJson){var e=new BMap.LocalSearch(mapSystem.map,{pageCapacity:20,onSearchComplete:function(m){if(mapSystem.lastReselectJson&&mapSystem.lastReselectJson.resetStartTime==f){var l=[];var k=m.getCurrentNumPois();var j=typeof(mapSystem.lastReselectJson.start)=="object";if(j){mapSystem.lastReselectJson.start.type=BMAP_POI_TYPE_NORMAL}var g=true;mapSystem.lastReselectJson.start.isStart=true;for(var h=0;h<k;h++){var n=m.getPoi(h);n.isStart=true;if(j&&n.point.equals(mapSystem.lastReselectJson.start.point)){l.push(mapSystem.lastReselectJson.start);g=false}else{l.push(n)}}if(g&&j){l=[mapSystem.lastReselectJson.start].concat(l)}mapSystem.lastReselectJson.resetStart=l;d.callee()}}});e.search(mapSystem.getReselectTitle(mapSystem.lastReselectJson.start))}};fish.one("#reselectStart h4").on("click",function(){if(mapSystem.lastReselectJson){var g=fish.all("#reselectStart h4");var e=g[0].parentNode;var d=fish.all(".list",fish.one(e));if(!mapSystem.lastReselectJson.resetStart){mapSystem.lastReselectJson.resetStartTime=new Date().getTime();c(arguments,mapSystem.lastReselectJson.resetStartTime);return}mapSystem.resetPoiContext();g.html(g.html().replace(/^(.+?：)[\s\S]*$/,"$1")+mapSystem.getReselectTitle(mapSystem.lastReselectJson.start));fish.dom(g).parentNode.className="rel_msg";var f=mapSystem.endMarker;mapSystem.resetView();mapSystem.endMarker=f;if(f){mapSystem.map.addOverlay(f)}a(mapSystem.lastReselectJson.resetStart,e);fish.all(fish.dom("#reselectEnd").children).each(function(h,j){if(j!=0){fish.dom("#reselectEnd").removeChild(fish.dom(this))}})}return false});var b=function(d,f){if(mapSystem.lastReselectJson){var e=new BMap.LocalSearch(mapSystem.map,{pageCapacity:20,onSearchComplete:function(n){if(mapSystem.lastReselectJson&&mapSystem.lastReselectJson.resetEndTime==f){var m=[];var l=n.getCurrentNumPois();var k=typeof(mapSystem.lastReselectJson.end)=="object";if(k){mapSystem.lastReselectJson.end.type=BMAP_POI_TYPE_NORMAL}var g=true;mapSystem.lastReselectJson.end.isStart=false;for(var j=0;j<l;j++){var h=n.getPoi(j);h.isStart=false;if(k&&h.point.equals(mapSystem.lastReselectJson.end.point)){m.push(mapSystem.lastReselectJson.end);g=false}else{m.push(h)}}if(g&&k){m=[mapSystem.lastReselectJson.end].concat(m)}mapSystem.lastReselectJson.resetEnd=m;d.callee()}}});e.search(mapSystem.getReselectTitle(mapSystem.lastReselectJson.end))}};fish.one("#reselectEnd h4").on("click",function(){if(mapSystem.lastReselectJson){var g=fish.all("#reselectEnd h4");var e=g[0].parentNode;var d=fish.all(".list",fish.one(e));if(!mapSystem.lastReselectJson.resetEnd){mapSystem.lastReselectJson.resetEndTime=new Date().getTime();b(arguments,mapSystem.lastReselectJson.resetEndTime);return}if(d.length==0){mapSystem.resetPoiContext();g.html(g.html().replace(/^(.+?：)[\s\S]*$/,"$1")+mapSystem.getReselectTitle(mapSystem.lastReselectJson.end));fish.dom(g).parentNode.className="rel_msg";var f=mapSystem.startMarker;mapSystem.resetView();mapSystem.startMarker=f;if(f){mapSystem.map.addOverlay(f)}a(mapSystem.lastReselectJson.resetEnd,e);fish.all(fish.dom("#reselectStart").children).each(function(h,j){if(j!=0){fish.dom("#reselectStart").removeChild(fish.dom(this))}})}else{if(fish.one(".msg_list",fish.one(e)).hasClass("none")){fish.one(".msg_list",fish.one(e)).removeClass("none")}else{fish.one(".msg_list",fish.one(e)).addClass("none")}}}return false});fish.one("#reselect_swap").on("click",function(){if(mapSystem.lastReselectJson){var d=mapSystem.lastReselectJson.start;mapSystem.lastReselectJson.start=mapSystem.lastReselectJson.end;mapSystem.lastReselectJson.end=d;d=mapSystem.lastReselectJson.resetStart;mapSystem.lastReselectJson.resetStart=mapSystem.lastReselectJson.resetEnd;mapSystem.lastReselectJson.resetEnd=d;mapSystem.resetView();mapSystem.reselectInput()}return false})},newCircle:null,huaCircle:function(b){var a=new BMap.Point(b.Lon,b.Lat);mapSystem.newCircle=new BMap.Circle(a,10000,{fillColor:"#7abcfc",strokeWeight:1,fillOpacity:0.5,strokeOpacity:0.3,enableEditing:false})},newRectangle:null,huaTangle:function(){mapSystem.newRectangle=new BMapLib.RectangleZoom(mapSystem.map,{strokeWeight:2,strokeColor:"red",style:"dashed",opacity:0.5,followText:"拖拽鼠标搜索景点",fillColor:"#f5f5f5",autoClose:true})},autoStart:null,autoEnd:null,autoStartArr:[],autoEndArr:[],autocompleteStart:function(a){mapSystem.autoStart=new BMap.Autocomplete({input:a,location:mapSystem.map})},autocompleteEnd:function(a){mapSystem.autoEnd=new BMap.Autocomplete({input:a,location:mapSystem.map})},init:function(a){if(a){this.data=a;_.pointCorr(a.mapInfo)}this._initMap();this._initElementEvent();this.viewSearch.init();this.transitHandle.init();this.driveHandle.init();this.otherHandle.init();this.HandleType="transitHandle"}};function openLoading(){var a=fish.one("#MapHolder").offset().left+fish.one("#MapHolder").width()-fish.one("#mapLoading").width(),b=fish.one("#MapHolder").offset().top;fish.one("#mapLoading").css("left:"+a+"px;top:"+b+"px");fish.one("#mapLoading").removeClass("none");fish.one(window).on("resize",function(){if(!fish.one("#mapLoading").hasClass("none")){var c=fish.one("#MapHolder").offset().left+fish.one("#MapHolder").width()-fish.one("#mapLoading").width(),d=fish.one("#MapHolder").offset().top;fish.one("#mapLoading").css("left:"+c+"px;top:"+d+"px")}})}function closeLoading(){fish.one("#mapLoading").addClass("none")}function setPanelHeight(){var a=fish.one("#mapPanel").height(),b=fish.one("#mapSearchBox").height();if(a<=b+fish.one("#resultInfo").height()){fish.dom("#resultInfo").style.overflowX="hidden";fish.one("#resultInfo").css("height:440px;overflow-y:auto;")}else{fish.dom("#resultInfo").style.overflowX="hidden";fish.one("#resultInfo").css("height:440px;overflow-y:auto;overflow-x:hidden")}}function resetControl(){var b=fish.one("#mapPanel"),a=fish.one("#mapControl");if(b.getCss("display")=="none"){a[0].className="map_expand"}else{a[0].className="map_retract"}}function animPanelOpen(){var a=fish.one("#mapPanel");if(a.getCss("display")=="none"){a.css("display:block;");a.anim("left: 950px",1000,{fn:function(){a.css("display:block")},easeing:function(){}})}}function animPanelClose(){var a=fish.one("#mapPanel");if(a.getCss("display")=="block"){a.anim("left: 674px",1000,{fn:function(){a.css("display:none")},easeing:function(){}})}}fish.one("#mapControl").on("click",function(){if(this.className=="map_expand"){this.className="map_retract";fish.one("#mapPanel").css("display:block")}else{this.className="map_expand";fish.one("#mapPanel").css("display:none")}});function sideConctrol(){var j=fish.one("#mapSearchBox .search_ipt"),d=fish.one("#mapSearchBox .search_bus"),e=fish.one("#mapSearchBox .search_car"),c=fish.one("#app-info"),b=fish.one("#map-app"),a=fish.all("#map-app, #app-info"),i=fish.one("#startDl"),h=fish.one("#endDl"),k=null,f=fish.one("#exchangeBtn");d.on("click",function(){if(fish.trim(fish.one(".mark_ipt",j).val())!==""){c.css("display:none");var m=fish.dom("#startDl .mark_ipt")?fish.dom("#startDl .mark_ipt").value:fish.one("#startDl .mark_txt").html(),l=fish.dom("#endDl .mark_txt")?fish.one("#endDl .mark_txt").html():fish.dom("#endDl .mark_ipt").value;mapSystem.searchNote.type=mapSystem.HandleType="transitHandle";if(mapSystem.searchNote&&mapSystem.searchNote.type=="transitHandle"){setTimeout(function(){mapSystem.contextSearch(m,l,"mouse")},500);fish.one("#mapPanelBton .taxi").html("自驾")}}else{fish.dom(".mark_ipt",j).focus()}});e.on("click",function(){if(fish.trim(fish.one(".mark_ipt",j).val())!==""){c.css("display:none");var m=fish.dom("#startDl .mark_ipt")?fish.dom("#startDl .mark_ipt").value:fish.one("#startDl .mark_txt").html(),l=fish.dom("#endDl .mark_txt")?fish.one("#endDl .mark_txt").html():fish.dom("#endDl .mark_ipt").value;mapSystem.searchNote.type=mapSystem.HandleType="driveHandle";if(mapSystem.searchNote&&mapSystem.searchNote.type=="driveHandle"){setTimeout(function(){mapSystem.contextSearch(m,l,"mouse")},500);fish.one("#mapPanelBton .taxi").html("公交")}}else{fish.dom(".mark_ipt",j).focus()}});a.each(function(l){fish.one(l).hover(function(){clearTimeout(k);c.css("display:block")},function(){k=setTimeout(function(){c.css("display:none")},200)})});f.on("click",function(){var m=fish.one("dd",i),l=fish.one("dd",h);i.html("bottom",l);h.html("bottom",m)});fish.one("#mapSearchBox .mark_ipt").on("blur",function(){if(fish.trim(fish.one(this).val())!==""&&fish.dom("#tabMain .start_name")){fish.one("#tabMain .start_name").val(fish.one(this).val());fish.one("#tabMain .end_name").val(fish.one(this).val())}});function g(){var l=document.createElement("div");l.className="map_loading none";l.id="mapLoading";l.innerHTML="Loading...";fish.dom("body").appendChild(l)}g()}function getSceneryMap(){var j=fish.trim(fish.one("#mapLng").val()),i=fish.trim(fish.one("#mapLat").val()),l=fish.trim(fish.one("#mapSId").val()),n=fish.trim(fish.one("#mapTcPrice").val()),m=fish.trim(fish.one("#mapSName").val()),h=fish.trim(fish.one("#mapImgUrl").val()),g=fish.trim(fish.one("#mapSAddr").val());var f={P:{type:"my",mapId:"MapHolder",mapInfo:{lng:j,lat:i,sId:l,tcPrice:n,sName:m,imgUrl:h,sAddr:g}}};if(typeof mapSystem!=undefined){mapSystem.init(f.P)}var e=f.P.mapInfo.sName;var o=mapSystem.jsonToPoint(mapSystem.data.mapInfo);var k={position:o,offset:new BMap.Size(15,-10),enableMassClear:false};var d=new BMap.Marker(o,{offset:new BMap.Size(0,10),title:e,enableMassClear:false});var c=new BMap.Label(e,k);mapSystem.map.addOverlay(d);mapSystem.map.addOverlay(c);var b=new BMap.InfoWindow(a(),{enableAutoPan:true});d.addEventListener("click",function(){this.openInfoWindow(b)});mapSystem.map.openInfoWindow(b,o);function a(){var v,t,w,u;v=f.P.mapInfo.sName;t=f.P.mapInfo.sAddr;w=parseFloat(f.P.mapInfo.tcPrice);u=toNewSrc(f.P.mapInfo.imgUrl);var p=document.createElement("div");p.className="scenery_tmap";var q=document.createElement("h3");q.className="tmap_tit";q.innerHTML='<a href="#" target="_blank">'+v+"</a>";var s=w>0?'<dd><span class="bt">同程价格：</span><span class="price">¥'+w+'<span style="color:#666;font-size: 12px;margin-left: 2px;">起</span></span></dd>':"";var r=document.createElement("div");var x=fish.one("#hf_attribute").val()=="0"?"景点地址":"商家地址";r.className="scenery_info";r.innerHTML='<dl><dt><a href="javascript:;"><img src="'+u+'"></a></dt><dd><span class="bt">'+x+"：</span>"+t+"</dd>"+s+"</dl>";var y=document.createElement("div");y.className="tab_main";y.id="tabMain";y.innerHTML='<div class="tmap_content"><ul class="tmap_nav"><li class="at"><div class="go-end"><span class="pic"></span>到这里去</div></li><li><div class="go-start"><span class="pic"></span>从这里出发 </div></li> </ul> <div class="tmap_main"><div class="val_content"><dl><dt><span class="start-ico"></span>起点：</dt><dd><input type="text" value="" class="place_name start_name"></dd><dd><a class="search_bton soso_bus_start" href="javascript:void(0)">公交</a><a class="search_bton soso_taxi_start" href="javascript:void(0)">驾车</a></dd></dl></div></div><div class="tmap_main none"><div class="val_content"><dl><dt><span class="end-ico"></span>终点：</dt><dd><input type="text" value="" class="place_name end_name"></dd><dd><a class="search_bton soso_bus_end" href="javascript:void(0)">公交</a><a class="search_bton soso_taxi_end" href="javascript:void(0)">驾车</a></dd></dl></div></div></div>';p.appendChild(q);p.appendChild(r);p.appendChild(y);fish.all(".end_name,.start_name",y).on("blur",function(){if(fish.trim(fish.one(this).val())!==""&&fish.one("#mapSearchBox .mark_ipt").val()!==fish.one(this).val()){fish.one("#mapSearchBox .mark_ipt").val(fish.one(this).val())}});(function(){var B=fish.all(".tmap_nav li",fish.one(y));var A=fish.all(".tmap_main",fish.one(y));B.on("click",function(){for(var C=0;C<B.length;C++){fish.all(B[C]).removeClass("at");fish.all(A[C]).addClass("none");if(this==B[C]){fish.one(B[C]).addClass("at");fish.one(A[C]).removeClass("none")}}});fish.one(".soso_bus_end",y).on("click",function(){var D=fish.one(".end_name",y).val();var C=z(D);if(C){mapSystem.searchNote.type=mapSystem.HandleType="transitHandle";if(mapSystem.searchNote&&mapSystem.searchNote.type=="transitHandle"){setTimeout(function(){mapSystem.contextSearch(v,D,"mouse")},500);fish.one("#mapPanelBton .taxi").html("自驾")}}else{fish.dom(".end_name",y).focus()}});fish.one(".soso_taxi_end",y).on("click",function(){var D=fish.one(".end_name",y).val();var C=z(D);if(C){mapSystem.searchNote.type=mapSystem.HandleType="driveHandle";if(mapSystem.searchNote&&mapSystem.searchNote.type=="driveHandle"){setTimeout(function(){mapSystem.contextSearch(v,D,"mouse")},500);fish.one("#mapPanelBton .taxi").html("公交")}}else{fish.dom(".end_name",y).focus()}});fish.one(".soso_bus_start",y).on("click",function(){var D=fish.one(".start_name",y).val();var C=z(D);if(C){mapSystem.searchNote.type=mapSystem.HandleType="transitHandle";if(mapSystem.searchNote&&mapSystem.searchNote.type=="transitHandle"){setTimeout(function(){mapSystem.contextSearch(D,v,"mouse")},500);fish.one("#mapPanelBton .taxi").html("自驾")}}else{fish.dom(".start_name",y).focus()}});fish.one(".soso_taxi_start",y).on("click",function(){var D=fish.one(".start_name",y).val();var C=z(D);if(C){mapSystem.searchNote.type=mapSystem.HandleType="driveHandle";if(mapSystem.searchNote&&mapSystem.searchNote.type=="driveHandle"){setTimeout(function(){mapSystem.contextSearch(D,v,"mouse")},500);fish.one("#mapPanelBton .taxi").html("公交")}}else{fish.dom(".start_name",y).focus()}});function z(C){if(fish.trim(C)==""){return false}else{return true}}})();return p}sideConctrol()}function loadScrollMap(){var a=fish.one("#MapHolder");if(!a){return}fish.one(window).on("scroll",function(){var b=fish.one("#MapHolder").offset().top-700;var c=document.documentElement.scrollTop||document.body.scrollTop;if(c>=b&&a.html()==""){getSceneryMap()}})}loadScrollMap();(function(){function m(a){z(a,this)}function z(a,f){var c={preSpace:0,failurelimit:10,attr:"orisrc",container:window,aniTime:300};a&&fish.lang.extend(c,a),setTimeout(function(){B(f,c)},2000),w(f,c),fish.one(c.container).on("scroll",function(){B(f,c)})}function w(a,c){a.each&&a.each(function(){var f=this;undefined==fish.one(f).attr(c.attr)&&fish.one(f).attr(c.attr,fish.one(f).attr("src"));if(c.placeholder){fish.one(f).attr("src",c.placeholder)}else{var h=fish.one(f);h.attr("src",y),h[0].style.background="url("+v+") scroll no-repeat center center #fff"}f.loaded=!1})}function B(a,c){c.timer&&clearTimeout(c.timer),c.timer=setTimeout(function(){var e=0;a.each(function(){if(!d(this,c)&&!k(this,c)){if(!j(this,c)&&!q(this,c)){b(this,c)}else{if(e++>c.failurelimit){return !1}}}})},100)}function b(a,f){var c=fish.one(a);a.loaded||(c.attr("src",c.attr(f.attr)),a.removeAttribute(f.attr),c.onerror=function(){a.err=!0})}function j(a,f){if(f.container===undefined||f.container===window){var c=fish.one(window).height()+fish.one(window).scrollTop()}else{var c=fish.one(f.container).offset().top+fish.one(f.container).height()}return c<=fish.one(a).offset().top-f.preSpace}function q(a,f){if(f.container===undefined||f.container===window){var c=fish.one(window).width()+fish.one(window).scrollLeft()}else{var c=fish.one(f.container).offset().left+fish.one(f.container).width()}return c<=fish.one(a).offset().left-f.preSpace}function d(a,f){if(f.container===undefined||f.container===window){var c=fish.one(window).scrollTop()}else{var c=fish.one(f.container).offset().top}return c>=fish.one(a).offset().top+f.preSpace+fish.one(a).height()}function k(a,f){if(f.container===undefined||f.container===window){var c=fish.one(window).scrollLeft()}else{var c=fish.one(f.container).offset().left}return c>=fish.one(a).offset().left+f.preSpace+fish.one(a).width()}function x(){var a="",f="",h="",c=-1,l=-1;return fish.all("script").each(function(){if(!fish.one(this).attr("src")){return}c=fish.one(this).attr("src").indexOf("lazyLoad");if(c>-1){return f=fish.one(this).attr("src"),a=f.match(/.*(?=lazyLoad\.)/g)[0],!1}}),h=a+A,h}var g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAMAAAAoyzS7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkY0RkEyNjlDQTYyQTExRTE4QTEzOTI0OUM1OERFNkVEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkY0RkEyNjlEQTYyQTExRTE4QTEzOTI0OUM1OERFNkVEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RjRGQTI2OUFBNjJBMTFFMThBMTM5MjQ5QzU4REU2RUQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RjRGQTI2OUJBNjJBMTFFMThBMTM5MjQ5QzU4REU2RUQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5K9V7MAAAABlBMVEXMzMwAAADTMzNkAAAADElEQVR42mJgAAgwAAACAAFPbVnhAAAAAElFTkSuQmCC",A="grey.png",v="http://img1.40017.cn/cn/comm/images/cn/public/transparent_loading_v2.gif?v=20140417",y="http://img1.40017.cn/cn/new_ui/public/images/transparent.gif";fish.extend({lazyLoad:m})})();fish.admin.config({mLogin:{v:"2.0",css:1,g:2012112073101}});var jqSliderFn={isMobile:/^0?(13|14|15|18|17)[0-9]{9}$/,userInfo:{},show_holder:[".jq_like",".jq_hb",".jq_act"],canClick:true,isLoginFn:function(){var d=fish.cookie.get("us");if(d){var b=d.split("&");for(var a=b.length-1;a>=0;a--){var c=b[a].split("=");jqSliderFn.userInfo[c[0]]=c[1]}}},showCon:function(){for(var a=jqSliderFn.show_holder.length-1;a>=0;a--){(function(b){fish.one(jqSliderFn.show_holder[b]).on("click",function(){fish.one("#hb_phone").val("");fish.one(".err_info").addClass("none");var c=fish.one(jqSliderFn.show_holder[b]);if(jqSliderFn.canClick){if(!c.hasClass("jq_now")){if(c.hasClass("jq_like")&&c.attr("is_ajax")=="false"){jqSliderFn.likeScroll();c.attr("is_ajax","true")}if(c.hasClass("jq_act")&&c.attr("is_ajax")=="false"){jqSliderFn.actFn();c.attr("is_ajax","true")}if(c.hasClass("jq_col")&&c.attr("is_ajax")=="false"){jqSliderFn.colAjaxFn();c.attr("is_ajax","true")}fish.all(".jq_user,.jq_like,.jq_tab li").removeClass("jq_now");c.addClass("jq_now");if(fish.one("#jq_slider_wrap").hasClass("show")){fish.all(".jq_slider_con").addClass("scale_down_apply").css("z-index:1000;");fish.one(jqSliderFn.show_holder[b]+"_h").removeClass("scale_down_apply").css("z-index:1001;visibility:visible;opacity:100;top:300px").anim("top:0px",750)}else{fish.all(".jq_slider_con").removeClass("scale_down_apply").css("z-index:1000;opacity:0;");fish.one(jqSliderFn.show_holder[b]+"_h").css("z-index:1001;visibility:visible;opacity:100")}fish.one("#jq_slider_wrap").addClass("show");fish.one(".jq_unfold").addClass("none");fish.one("#jq_slider_wrap").anim("right:0px;",500)}else{jqSliderFn.hideBarFn()}}})})(a)}},stateRemove:function(){for(var a=jqSliderFn.show_holder.length-1;a>=0;a--){(function(b){fish.one(jqSliderFn.show_holder[b]).removeClass("jq_now")})(a)}},hideBarFn:function(a){jqSliderFn.canClick=false;jqSliderFn.stateRemove();fish.one("#jq_slider_wrap").removeClass("show");fish.one("#jq_slider_wrap").anim("right:-230px;",800,{fn:function(){jqSliderFn.canClick=true;if(a){a()}}})},closeFn:function(){fish.all(".jq_back").on("click",function(){jqSliderFn.hideBarFn()})},tolCloseFn:function(){function a(){jqSliderFn.canClick=false;fish.one(".jq_unfold").removeClass("none").anim("left:-40px",300,{fn:function(){jqSliderFn.canClick=true}});fish.one(".jq_slider").anim("left:40px",300)}fish.one(".jq_btm_close").on("click",function(){if(fish.one("#jq_slider_wrap").hasClass("show")){jqSliderFn.hideBarFn(a)}else{a()}});fish.one(".jq_unfold").on("click",function(){jqSliderFn.stateRemove();fish.one(".jq_unfold").anim("left:48px",300,{fn:function(){fish.one(".jq_unfold").addClass("none")}});fish.one(".jq_slider").anim("left:0px",300)})},likeScroll:function(){var a=window;if(a.yzf_data){jqSliderFn.buildLikeData(a.yzf_data);return}fish.ajax({url:"/scenery/AjaxHelper/AjaxCall.aspx?action=GETSCENERYLISTREC&cityId="+fish.one("#hf_CookieCityId").val(),type:"json",fn:function(b){a.yzf_data=b.content;jqSliderFn.buildLikeData(a.yzf_data)}})},buildLikeData:function(d){if(d.length){fish.one(".jq_fav_c ul").html("");var f="";if(d.length>0){var c=d.length>10?10:d.length;for(var b=0;b<c;b++){var a=d[b];var e="/scenery/BookSceneryTicket_"+a.sceneryId+".html";e=a.batchNo?e+"#Resys="+a.batchNo:"";e+="?spm=1.68076534.6781."+(b+1);f+='<li>                                        <a href="'+e+'" target="_blank">                                            <div class="img_wrap">                                                <img nsrc="'+a.SceneryPic+'" alt="">                                            </div>                                            <div class="btm">                                                <p>'+a.sceneryName+'</p>                                                <div>                                                    <span class="price">&yen;<i>'+a.lowTcPrice+"</i></span>                                                </div>                                            </div>                                         </a>                                    </li>"}}fish.one(".jq_fav_c ul").html(f);loadWebp({attr:"nsrc",img:fish.all(".jq_fav_c ul img"),replace:true});fish.mScrollpane({wheelNum:50,container:".jq_fav_c .jq_ins_container",shower:".jq_fav_c .jq_ins_shower",scroller:".jq_fav_c .jq_ins_scroll",scroll_bar:".jq_fav_c .jq_ins_scroll_bar",defaultStyle:true})}},toTop:function(){fish.one(window).on("scroll",function(){var a=jqSliderFn.getHeight();if(a<600){fish.all(".jq_btm_top").addClass("none");if(fish.one(window).scrollTop()>200){fish.all(".to_top").removeClass("none")}else{fish.all(".to_top").addClass("none")}}else{fish.all(".to_top").addClass("none");if(fish.one(window).scrollTop()>200){fish.all(".jq_btm_top").removeClass("none")}else{fish.all(".jq_btm_top").addClass("none")}}h_Reset()})},privilegeFn:function(){if(jqSliderFn.userInfo.userid){jqSliderFn.show_holder.push(".jq_user");var a=jqSliderFn.userInfo.level;var c=parseInt(a)+1;var b=["普通","白银","黄金","铂金","砖石"];fish.one(".jq_user span").html("我的特权<i></i>");fish.one(".p_c_t_r .name").html("Hi "+jqSliderFn.userInfo.nickName);fish.one(".p_c_t_r .level").html("您是V"+c+b[a]+"会员");fish.one(".p_c_t_l span i").html("").addClass("vip"+a);fish.one("#hb_phone").val("");fish.one(".jq_user").addClass("logined");switch(c){case 5:case 4:fish.all(".p_c_ts").addClass("at");case 3:fish.all(".p_c_dr").addClass("at");case 2:fish.all(".p_c_yz").addClass("at");case 1:fish.all(".p_c_gw").addClass("at");break}jqSliderFn.colAjaxFn()}else{fish.one(".jq_user").on("click",function(){fish.mLogin({unReload:false,loginSuccess:function(){}})})}},actFn:function(){fish.ajax({url:"/scenery/AjaxHelper/AjaxCall.aspx?action=SceneryAreaMarketingSearch&cityId="+fish.one("#hf_CookieCityId").val()+"&proId="+fish.one("#hf_CookieProvinceId").val()+"&modulesId=6100129",type:"json",fn:function(a){if(a.length>0){fish.one(".jq_act_h ul").html("");var d="";for(var c=0;c<a.length;c++){var b=a[c];d+='<li>                                        <a href="'+b.Url+'" target="_blank">                                            <img nsrc="'+b.ImageUrl+'" alt="'+b.SceneryName+'">                                        </a>                                    </li>'}fish.one(".jq_act_h ul").html(d);loadWebp({attr:"nsrc",img:fish.all(".jq_act_h ul img"),replace:true});fish.mScrollpane({wheelNum:50,container:".jq_act_c .jq_ins_container",shower:".jq_act_c .jq_ins_shower",scroller:".jq_act_c .jq_ins_scroll",scroll_bar:".jq_act_c .jq_ins_scroll_bar",defaultStyle:true})}}})},hbFn:function(){inputIeplaceholder("hb_phone","333","999");fish.one(".hb_get").on("click",function(){var b=fish.one("#hb_phone");var a=fish.trim(b.val());if(a==""||!jqSliderFn.isMobile.test(a)){fish.one(".err_info").html("请输入正确的手机号").removeClass("none")}else{fish.one(".err_info").addClass("none");fish.ajax({url:"/scenery/AjaxHelper/ZhuanTiHelp/ZTAjaxCall.aspx",data:"action=GETSPMLIBAO&ChannelID=5144&Mobile="+a,type:"json",fn:function(c){if(c){if(c.State=="5"){fish.one(".jq_hb_c").addClass("none");fish.all(".hb_c_r,.c_r_t.s1").removeClass("none")}else{if(c.State=="6"){fish.one(".jq_hb_c").addClass("none");fish.all(".hb_c_r,.c_r_t.s2").removeClass("none")}else{if(c.State=="200"){fish.one(".jq_hb_c").addClass("none");fish.all(".hb_c_r,.c_r_t.s3").removeClass("none")}else{fish.one(".err_info").html(c.Magess).removeClass("none")}}}}}})}})},colFn:function(){if(jqSliderFn.userInfo.userid){jqSliderFn.show_holder.push(".jq_col")}else{fish.one(".jq_col").on("click",function(){fish.mLogin({unReload:false,loginSuccess:function(){}})})}},colAjaxFn:function(){fish.ajax({url:"/scenery/AjaxHelper/AjaxCall.aspx?action=QueryFavourite",type:"json",fn:function(b){var a=b.scenerylist;var e="";if(a.length>0){fish.one(".jq_col_c ul").html("");for(var d=a.length;d>0;d--){var c=a[d-1];e+='<li>                                        <a href="/scenery/BookSceneryTicket_'+c.SceneryId+'.html" target="_blank">                                            <div class="img_wrap">                                                <img nsrc="'+c.ImageUrl+'" alt="">                                            </div>                                            <div class="btm">                                                <p>'+c.SceneryName+'</p>                                                <div>                                                    <span class="price">&yen;<i>'+c.TCPrice+"</i></span>                                                </div>                                            </div>                                         </a>                                    </li>"}fish.one(".jq_col_c ul").html(e);loadWebp({attr:"nsrc",img:fish.all(".jq_col_c ul img"),replace:true})}else{fish.one(".jq_col_c").html("");e=' <div class="jq_col_c_n">                                <i></i>                                    <p class="tip">您的收藏暂时没有景区产品</p>                                    <div>                                        <p>您可以查看当前所在城市的<a href="http://www.ly.com/scenery/scenerysearchlist_'+fish.one("#hf_CookieProvinceId").val()+"_"+fish.one("#hf_CookieCityId").val()+'__0_0_0_0_0_0_0.html" target="_blank">景区频道</a>，或搜寻您喜爱的产品，添加到收藏夹。</p>                                        <a class="how" href="http://www.ly.com/newhelp/questionlist/1-8.html" target="_blank">如何使用收藏夹?</a>                                    </div>                                </div>';fish.one(".jq_col_c").html(e)}}})},hideToolBarFn:function(){var a=jqSliderFn.getHeight();if(a<600){fish.all(".jq_unfold,.jq_slider_inner").addClass("none");fish.all(".jq_btm_top").addClass("none");if(fish.one(window).scrollTop()>200){fish.all(".to_top").removeClass("none")}else{fish.all(".to_top").addClass("none")}}else{fish.all(".jq_unfold,.jq_slider_inner").removeClass("none");fish.all(".to_top").addClass("none");if(fish.one(window).scrollTop()>200){fish.all(".jq_btm_top").removeClass("none")}else{fish.all(".jq_btm_top").addClass("none")}}},getHeight:function(){var a=window.innerHeight;if(typeof a!="number"){if(document.compatMode=="CSS1Compat"){a=document.documentElement.clientHeight}else{a=document.body.clientHeight}}return a},init:function(){jqSliderFn.isLoginFn();jqSliderFn.privilegeFn();jqSliderFn.colFn();jqSliderFn.showCon();jqSliderFn.closeFn();jqSliderFn.tolCloseFn();jqSliderFn.toTop();jqSliderFn.hideToolBarFn();window.onresize=jqSliderFn.hideToolBarFn;fish.all(".jq_btm_top,.to_top").on("click",function(){var a=0;var b=setInterval(function(){var c=document.body.scrollTop||document.documentElement.scrollTop;if(c>0){if(document.body.scrollTop){document.body.scrollTop=document.body.scrollTop-30*(++a)}else{document.documentElement.scrollTop=document.documentElement.scrollTop-30*(++a)}}else{clearInterval(b)}},20)})}};var btmFn={init:function(){function b(){fish.one(".appxb-header").anim("left:-206px",500,function(){fish.one(".appxb-con").anim("left: 0px",1000);fish.one(".appxb-con").removeClass("none")})}function a(){fish.one(".appxb-con").anim("left: -100%",1000,function(){fish.one(".appxb-con").addClass("none");fish.one(".appxb-header").anim("left:0px",500)})}fish.one(".warp-close").on("click",function(){a()});fish.one(".appxb-header").on("click",function(){b()})}};var advFn={sliderAdv:function(){fish.ajax({url:"/scenery/AjaxHelper/AjaxCall.aspx?action=SceneryAreaMarketingSearch&modulesId=6100138",type:"json",fn:function(a){if(a&&a[0]){var b=a[0];var c='<img class="s_img" src="'+b.Summary+'" alt="">                                <div class="jq_top_con">                                    <a target="_blank" href="'+b.Url+'"><img src="'+b.ImageUrl+'" alt=""></a>                                </div>';fish.one(".jq_top").html(c)}}})},init:function(){advFn.sliderAdv();if(fish.one(".appxb").length){btmFn.init()}}};fish.loaded(function(){window.sys={};var b=navigator.userAgent.toLowerCase();var a;(a=b.match(/msie ([\d.]+)/))?sys.ie=a[1]:(a=b.match(/firefox\/([\d.]+)/))?sys.firefox=a[1]:(a=b.match(/chrome\/([\d.]+)/))?sys.chrome=a[1]:(a=b.match(/opera\/.*version\/([\d.]+)/))?sys.opera=a[1]:(a=b.match(/version\/([\d.]+).*safari/))?sys.safari=a[1]:0;if(/webkit/.test(b)){sys.webkit=b.match(/webkit\/([\d.]+)/)[1]}jqSliderFn.init();advFn.init();fish.on("click",function(c){zyClickFn(c,"jq_slider_wrap")},document);h_Reset()});function inputIeplaceholder(e,c,a){var b=document,d=b.getElementById(e),g="placeholder" in b.createElement("input"),f=function(j){var k=j.getAttribute("placeholder"),i=j.defaultValue;if(i==""){j.value=k;j.style.color="#"+a}j.onfocus=function(){if(j.value===k){this.value="";this.style.color="#"+c}};j.onblur=function(){if(j.value===""){this.value=k;this.style.color="#"+a}}};if(!g){var h=d.getAttribute("placeholder");if(h){f(d)}}}function zyClickFn(a,b){var c=fish.getTarget(a);var d=false;if(c.id==b){d=true}else{while(c&&c.localName!="body"){c=c.parentNode;if(c!=null){if(c.id==b){d=true;break}}}}if(!d){jqSliderFn.hideBarFn()}}Object.defineProperty(Element.prototype,"outerHeight",{get:function(){var b=this.clientHeight;var a;if(this.currentStyle){a=this.currentStyle}else{a=window.getComputedStyle(this)}b+=parseInt(a.marginTop,10)?parseInt(a.marginTop,10):0;b+=parseInt(a.marginBottom,10)?parseInt(a.marginBottom,10):0;b+=parseInt(a.borderTopWidth,10)?parseInt(a.borderTopWidth,10):0;b+=parseInt(a.borderBottomWidth,10)?parseInt(a.borderBottomWidth,10):0;return b}});function getNewHeight(){var c=fish.all(".jq_slider").children();var a=0,b=0;c.each(function(){a+=this.outerHeight});b=a-118;return b}function h_Reset(){if(jqSliderFn.getHeight()<getNewHeight()&&(!fish.all(".jq_col").hasClass("none"))){fish.all(".jq_col").addClass("none")}else{if(jqSliderFn.getHeight()<(getNewHeight()+fish.dom(".jq_col").outerHeight)){fish.all(".jq_col").removeClass("none")}}};